<!DOCTYPE html>
<html>
<head>
<title>Ship Crew Editor</title>
<style>
table, th, td { border: 1px solid black; text-align: left; }
</style>
<script type="text/javascript">
  var total = {{ band['Treasury'] }};
  var current = {{ band['Treasury'] }};

  {% if 'Ensign' in band.keys():  %}
  var engHire = true;
  var hadEnsign = true;
  {%else%}
  var engHire = false;
  var hadEnsign = false;
  {% endif %} 

  var boughtarr_old = [];
  {% for item in band['Bought'] %}
      boughtarr_old.push(item);

  {% endfor %} 


  function hireEng()
			{
        boughtarr_old[10] = false;
        boughtarr_old[12] = false;
				if(engHire == false)
				{
					engHire = true;
					document.getElementById("ensignDiv").style.display = "block";
					
					updateCost();
				}
				else
				{
					engHire = false;
					document.getElementById("ensignDiv").style.display = "none";
					
					updateCost();
				}
			}

function topup()
      {
        var top = document.getElementsByName("topup")

        for (var i = 0; i < top.length; i++)
            {
              if (top[i].checked)
                  {
                    var topnum = parseInt(top[i].value);
                  }
            }
          
        total = total + topnum;
        current = current + topnum;
        remainingGold.innerHTML = current;

        validate(current);
      }  





  function updateTableRow(row, x)
			{
        boughtarr_old[row - 1] = false;
				var sel = x.value;
				
				var myTable = document.getElementById('rosterTable');

				if(sel == "Empty")
				{
					myTable.rows[row].cells[1].innerHTML = '-';
					myTable.rows[row].cells[2].innerHTML = '-';
					myTable.rows[row].cells[3].innerHTML = '-';
					myTable.rows[row].cells[4].innerHTML = '-';
					myTable.rows[row].cells[5].innerHTML = '-'
					myTable.rows[row].cells[6].innerHTML = '-';
					myTable.rows[row].cells[7].innerHTML = 0;
					myTable.rows[row].cells[8].innerHTML = '-';
				}
                                {% for troop in people.keys() %}
                                if(sel == "{{troop}}")
                                {
                                        myTable.rows[row].cells[1].innerHTML = '{{ people[troop]['Move'] }}';
                                        myTable.rows[row].cells[2].innerHTML = '{{ people[troop]['Fight'] }}';
                                        myTable.rows[row].cells[3].innerHTML = '{{ people[troop]['Shoot'] }}';
                                        myTable.rows[row].cells[4].innerHTML = '{{ people[troop]['Shield'] }}';
                                        myTable.rows[row].cells[5].innerHTML = '{{ people[troop]['Morale'] }}';
                                        myTable.rows[row].cells[6].innerHTML = '{{ people[troop]['Health'] }}';
                                        myTable.rows[row].cells[7].innerHTML = {{ people[troop]['Cost'] }};
                                        myTable.rows[row].cells[8].innerHTML = '{{ people[troop]['Notes'] }}';

                                }
                                {% endfor %}
                                updateCost();
                        }

  function updateCapWeapon()
      {
            boughtarr_old[11] = false;
            updateCost()
      }

  function updateCapWeapon2()
      {
            boughtarr_old[13] = false;
            updateCost()
      }

  function updateEensWeapon()
      {
            boughtarr_old[12] = false;
            updateCost()
      }

  function updateCost()
      {
       var sum = 0;
       var myTable = document.getElementById('rosterTable');
       for(i = 0; i <= 9; i++)
       {
        if (boughtarr_old[i] == false)
        {
          sum = sum + parseInt(myTable.rows[i + 1].cells[7].innerHTML);
        }
       }



        if(boughtarr_old[11] == false)
        {
            var capweap = document.getElementById('capweapsel');
            {% for weap in weapcost.keys() %}
            if(capweap.value == "{{ weap }}") 
            {
            sum = sum + {{ weapcost[weap] }};
            } 

            {% endfor %}
        }

        if(boughtarr_old[13] == false)
        {
            var capweap2 = document.getElementById('capweapsel2');
            {% for weap in weapcost.keys() %}
            if(capweap2.value == "{{ weap }}") 
            {
            sum = sum + {{ weapcost[weap] }};
            } 

            {% endfor %}
        }


        if (boughtarr_old[10] == false)
        {
        if(engHire)
         {
          sum = sum + 250;
          if (boughtarr_old[12] == false)
          {
          var ensweap = document.getElementById('ensweapsel');
          {% for weap in weapcost.keys() %}
          if(ensweap.value == "{{ weap }}") 
          {
            sum = sum + {{ weapcost[weap] }};
          }
          {% endfor %}
          }
         }
        }
        current = total - sum ;
        remainingGold.innerHTML = current ;
        validate(current);
      }


  function validate(curr)
  {
        var capweap = document.getElementById('capweapsel').value;
        var capweapcost = 0;
        {% for weap in weapcost.keys() %}

        if(capweap == "{{ weap }}")
        {
          capweapcost = {{ weapcost[weap] }};
        }
        {% endfor %}
        tempcap = curr + capweapcost;

        var capweap2 = document.getElementById('capweapsel2').value;
        var capweapcost2 = 0;
        {% for weap in weapcost.keys() %}

        if(capweap2 == "{{ weap }}")
        {
          capweapcost2 = {{ weapcost[weap] }};
        }
        {% endfor %}
        tempcap2 = curr + capweapcost2;



        if(engHire)
        {
          var ensweap = document.getElementById('ensweapsel').value;
          var ensweapcost = 0;
          {% for weap in weapcost.keys() %}
          if (ensweap == "{{ weap }}")
          {
            ensweapcost = {{ weapcost[weap] }};
          }
          {% endfor %}
          tempens = curr + ensweapcost;
        }
        

        var myTable = document.getElementById('rosterTable');
        var troopcost = [];
        for(i = 1; i <= 10; i++)
        {
          troopcost.push(parseInt(myTable.rows[i].cells[7].innerHTML));
        }

        var temptroop = [];
        for(i = 0; i <= 9; i++)
        {
          temptroop.push(troopcost[i] + curr);
        }



        {% for weap in weapcost.keys() %}
        if(tempcap < {{ weapcost[weap] }})
        {
          document.getElementById("{{ weap }}").disabled = true;
        } else{
          document.getElementById("{{ weap }}").disabled = false;
        }

        if(tempcap2 < {{ weapcost[weap] }})
        {
          document.getElementById("{{ weap }}2").disabled = true;
        } else{
          document.getElementById("{{ weap }}2").disabled = false;
        }

        if(engHire)
        {
          if(tempens < {{ weapcost[weap] }})
        {
          document.getElementById("{{ weap }}ens").disabled = true;
        } else{
          document.getElementById("{{ weap }}ens").disabled = false;
        }
        }
        {% endfor %}

      {% for i in range(1,11) %}

        {% for tros in people.keys() %}
        
              if(temptroop[i - 1] < {{ people[tros]['Cost'] }})
              {
                document.getElementById("{{ tros }}{{ i }}").disabled = true;
              } else{
                document.getElementById("{{ tros }}{{ i }}").disabled = false;
              }
            
        {% endfor %}

      {% endfor %}

       var ensbox =document.getElementById("appHire");
       if (ensbox.checked == false)
           {
            if (curr < 250)
                {
                  ensbox.disabled = true;
                } else{
                  ensbox.disabled = false;
                }
           }

    }



   function setCapSkillchoice(x)
   {                          
                               var choice = x.value;
                               var myTable = document.getElementById('wizardTable');
                                var list = myTable.rows[1].cells[10];         
                                        while (list.hasChildNodes()) {
                                              list.removeChild(list.firstChild);
                                        }
                               if(choice == "Empty")
			       {        
             				 list.appendChild(document.createTextNode("No Skills"));
			       }
                               {% for spec in skills.keys() %}
                               if(choice == "{{spec}}")
                               {
                                        var div = document.createElement("div");
 					{% for element in skills[spec] %}
                                           var tempbutton = document.createElement("input");
					   tempbutton.setAttribute("type", "radio");
					   tempbutton.setAttribute("id", "skillchoice");
					   tempbutton.setAttribute("name", "skillchoice");
					   tempbutton.setAttribute("value", "{{element}}");
                                           var templabel = document.createElement("label");
                                           templabel.appendChild(document.createTextNode("{{element}}"));
                                           div.appendChild(tempbutton);
					   div.appendChild(templabel);
  					{% endfor %}
                                        list.appendChild(div);
                                        
             
                               }            
                               {% endfor %}
   }

    function setEnsSkillchoice(x)
   {
                               var choice = x.value;
                               var myTable = document.getElementById('ensignTable');
                                var list = myTable.rows[1].cells[9];
                                        while (list.hasChildNodes()) {
                                              list.removeChild(list.firstChild);
                                        }
                               if(choice == "Empty")
                               {
                                         list.appendChild(document.createTextNode("No Skills"));
                               }
                               {% for spec in skills.keys() %}
                               if(choice == "{{spec}}")
                               {
                                        var div = document.createElement("div");
                                        {% for element in skills[spec] %}
                                           var tempbutton = document.createElement("input");
                                           tempbutton.setAttribute("type", "radio");
                                           tempbutton.setAttribute("id", "skillchoiceens");
                                           tempbutton.setAttribute("name", "skillchoiceens");
                                           tempbutton.setAttribute("value", "{{element}}");
                                           var templabel = document.createElement("label");
                                           templabel.appendChild(document.createTextNode("{{element}}"));
                                           div.appendChild(tempbutton);
                                           div.appendChild(templabel);
                                        {% endfor %}
                                        list.appendChild(div);


                               }
                               {% endfor %}
   }


   function capBattle()
   {   
       document.getElementById('capBattleButton').disabled = true;
       var capexp = document.getElementById('capexp');
       capexp.value = parseInt(capexp.value) + 10;

       var capButtons = document.getElementsByClassName('capButton');
       for(i = 0; i < capButtons.length; i++)
       {
        capButtons[i].disabled = false;
       }

       var capFightButton = document.getElementById('capFightButton');
       if (parseInt(document.getElementById('capfig').value) >= 10)
       {
          capFightButton.disabled = true;
       }

       var capShootButton = document.getElementById('capShootButton');
       if (parseInt(document.getElementById('capsho').value) >= 10)
       {
          capShootButton.disabled = true;
       }

       var capMoraleButton = document.getElementById('capMoraleButton');
       if (parseInt(document.getElementById('capmor').value) >= 12)
       {
          capMoraleButton.disabled = true;
       }

       var capHealthButton = document.getElementById('capHealthButton');
       if (parseInt(document.getElementById('caphea').value) >= 20)
       {
          capHealthButton.disabled = true;
       }

       var capsks = document.getElementsByClassName('capsk');
       for(i = 0; i < capsks.length; i++)
       {
        if (capsks[i].checked == false)
        {
          capsks[i].disabled = false;
        }
        
       }
   }

   function capStatChange(item)
   {
       document.getElementById('capBattleButton').disabled = false;

       var capButtons = document.getElementsByClassName('capButton');
       for(i = 0; i < capButtons.length; i++)
       {
        capButtons[i].disabled = true;
       }

       var capsks = document.getElementsByClassName('capsk');
       for(i = 0; i < capsks.length; i++)
       {
        capsks[i].disabled = true;
       }
        
       item.value++;

   }

   function capSkill()
   {
       document.getElementById('capBattleButton').disabled = false;

       var capButtons = document.getElementsByClassName('capButton');
       for(i = 0; i < capButtons.length; i++)
       {
        capButtons[i].disabled = true;
       }
       
       var capsks = document.getElementsByClassName('capsk');
       for(i = 0; i < capsks.length; i++)
       {
        capsks[i].disabled = true;
       }

   }




   function ensBattle()
   {   
       document.getElementById('ensBattleButton').disabled = true;
       var ensexp = document.getElementById('ensexp');
       ensexp.value = parseInt(ensexp.value) + 10;

       var ensButtons = document.getElementsByClassName('ensButton');
       for(i = 0; i < ensButtons.length; i++)
       {
        ensButtons[i].disabled = false;
       }

       var ensFightButton = document.getElementById('ensFightButton');
       if (parseInt(document.getElementById('enfig').value) >= 6)
       {
          ensFightButton.disabled = true;
       }

       var ensShootButton = document.getElementById('ensShootButton');
       if (parseInt(document.getElementById('ensho').value) >= 5)
       {
          ensShootButton.disabled = true;
       }

       var ensMoraleButton = document.getElementById('ensMoraleButton');
       if (parseInt(document.getElementById('enmor').value) >= 6)
       {
          ensMoraleButton.disabled = true;
       }

       var ensHealthButton = document.getElementById('ensHealthButton');
       if (parseInt(document.getElementById('enhea').value) >= 16)
       {
          ensHealthButton.disabled = true;
       }

       var enssks = document.getElementsByClassName('enssk');
       for(i = 0; i < enssks.length; i++)
       {
        if (enssks[i].checked == false)
        {
          enssks[i].disabled = false;
        }
        
       }
   }

   function ensStatChange(item)
   {
       document.getElementById('ensBattleButton').disabled = false;

       var ensButtons = document.getElementsByClassName('ensButton');
       for(i = 0; i < ensButtons.length; i++)
       {
        ensButtons[i].disabled = true;
       }

       var enssks = document.getElementsByClassName('enssk');
       for(i = 0; i < enssks.length; i++)
       {
        enssks[i].disabled = true;
       }
        
       item.value++;

   }

   function ensSkill()
   {
       document.getElementById('ensBattleButton').disabled = false;

       var ensButtons = document.getElementsByClassName('ensButton');
       for(i = 0; i < ensButtons.length; i++)
       {
        ensButtons[i].disabled = true;
       }
       
       var enssks = document.getElementsByClassName('enssk');
       for(i = 0; i < enssks.length; i++)
       {
        enssks[i].disabled = true;
       }

   }

   
   function doFormSubmit()
   {
    var num_Squad = 0;
     if (engHire)
     {
      num_Squad++;
     }
     for(i = 1; i <= 10; i++)
     {
      var troopss = document.getElementById('troop' + i)
      if (troopss.value != "Empty")
      {
        num_Squad++;
      }
     }
     if (num_Squad > 9)
     {
      alert("Each squad can have a maximum of ten members (including the Captain and Ensign)!")
     } else{




     method =  "post"; // Set method to post by default if not specified.

    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", "/edit/{{ band['Name'] }}");
 
    var boughtarr = [false, false, false, false, false, false, false, false, false, false, false, true, false, true];

    if (document.getElementById('public').checked == true)
    {
      var public = true;
    } else{
      var public = false;
    }

    if (document.getElementById('capweapsel').value != "Empty")
        {
          boughtarr[11] = true;
        }
    
    if (document.getElementById('capweapsel2').value != "Empty")
        {
          boughtarr[13] = true;
        }
    
    var publicstat = document.createElement("input");
            publicstat.setAttribute("type", "hidden");
            publicstat.setAttribute("name", "publicstat");
            publicstat.setAttribute("value", public);
            form.appendChild(publicstat);
    var bandname = document.createElement("input");
            bandname.setAttribute("type", "hidden");
            bandname.setAttribute("name", "bandname");
            bandname.setAttribute("value", document.getElementById('bandnametext').value);
            form.appendChild(bandname);
    var currentmoney = document.createElement("input");
            currentmoney.setAttribute("type", "hidden");
            currentmoney.setAttribute("name", "currentmoney");
            currentmoney.setAttribute("value", current);
            form.appendChild(currentmoney);
     var capspec = document.createElement("input");
            capspec.setAttribute("type", "hidden");
            capspec.setAttribute("name", "capspec");
            capspec.setAttribute("value", document.getElementById('capspecsel').value);
            form.appendChild(capspec);
//start
      var capmove = document.createElement("input");
            capmove.setAttribute("type", "hidden");
            capmove.setAttribute("name", "capmove");
            capmove.setAttribute("value", document.getElementById('capmov').value);
            form.appendChild(capmove);
 var capfight = document.createElement("input");
            capfight.setAttribute("type", "hidden");
            capfight.setAttribute("name", "capfight");
            capfight.setAttribute("value", document.getElementById('capfig').value);
            form.appendChild(capfight);
 var capshoot = document.createElement("input");
            capshoot.setAttribute("type", "hidden");
            capshoot.setAttribute("name", "capshoot");
            capshoot.setAttribute("value", document.getElementById('capsho').value);
            form.appendChild(capshoot);
 var capshield = document.createElement("input");
            capshield.setAttribute("type", "hidden");
            capshield.setAttribute("name", "capshield");
            capshield.setAttribute("value", document.getElementById('capshi').value);
            form.appendChild(capshield);
 var capmorale = document.createElement("input");
            capmorale.setAttribute("type", "hidden");
            capmorale.setAttribute("name", "capmorale");
            capmorale.setAttribute("value", document.getElementById('capmor').value);
            form.appendChild(capmorale);
 var caphealth = document.createElement("input");
            caphealth.setAttribute("type", "hidden");
            caphealth.setAttribute("name", "caphealth");
            caphealth.setAttribute("value", document.getElementById('caphea').value);
            form.appendChild(caphealth);
 var capexperience = document.createElement("input");
            capexperience.setAttribute("type", "hidden");
            capexperience.setAttribute("name", "capexperience");
            capexperience.setAttribute("value", document.getElementById('capexp').value);
            form.appendChild(capexperience);     
//end
     var capskills = []
     var capskillarr =  document.getElementsByName("capskil");
     for(k=0;k<capskillarr.length;k++)
     {
       if (capskillarr[k].checked)
       {
       capskills.push(capskillarr[k].value);
       }
     }
     var capskill = document.createElement("input");
            capskill.setAttribute("type", "hidden");
            capskill.setAttribute("name", "capskill");
            capskill.setAttribute("value", JSON.stringify(capskills));
            form.appendChild(capskill);
     var capweap = document.createElement("input");
            capweap.setAttribute("type", "hidden");
            capweap.setAttribute("name", "capweap");
            capweap.setAttribute("value", document.getElementById('capweapsel').value);
            form.appendChild(capweap);
     var capweap2 = document.createElement("input");
            capweap2.setAttribute("type", "hidden");
            capweap2.setAttribute("name", "capweap2");
            capweap2.setAttribute("value", document.getElementById('capweapsel2').value);
            form.appendChild(capweap2);


     if (engHire)
     {
        boughtarr[10] = true;
        if (document.getElementById('ensweapsel').value != "Empty")
        {
          boughtarr[12] = true;
        }

      var hasensign = document.createElement("input");
            hasensign.setAttribute("type", "hidden");
            hasensign.setAttribute("name", "hasensign");
            hasensign.setAttribute("value", engHire);
            form.appendChild(hasensign);
      var ensspec = document.createElement("input");
            ensspec.setAttribute("type", "hidden");
            ensspec.setAttribute("name", "ensspec");
            ensspec.setAttribute("value", document.getElementById('ensskillsel').value);
            form.appendChild(ensspec);

       //start
     var enmove = document.createElement("input");
            enmove.setAttribute("type", "hidden");
            enmove.setAttribute("name", "ensmove");
            enmove.setAttribute("value", document.getElementById('enmov').value);
            form.appendChild(enmove);
 var enfight = document.createElement("input");
            enfight.setAttribute("type", "hidden");
            enfight.setAttribute("name", "ensfight");
            enfight.setAttribute("value", document.getElementById('enfig').value);
            form.appendChild(enfight);
 var enshoot = document.createElement("input");
            enshoot.setAttribute("type", "hidden");
            enshoot.setAttribute("name", "ensshoot");
            enshoot.setAttribute("value", document.getElementById('ensho').value);
            form.appendChild(enshoot);
 var enshield = document.createElement("input");
            enshield.setAttribute("type", "hidden");
            enshield.setAttribute("name", "ensshield");
            enshield.setAttribute("value", document.getElementById('enshi').value);
            form.appendChild(enshield);
 var enmorale = document.createElement("input");
            enmorale.setAttribute("type", "hidden");
            enmorale.setAttribute("name", "ensmorale");
            enmorale.setAttribute("value", document.getElementById('enmor').value);
            form.appendChild(enmorale);
 var enhealth = document.createElement("input");
            enhealth.setAttribute("type", "hidden");
            enhealth.setAttribute("name", "enshealth");
            enhealth.setAttribute("value", document.getElementById('enhea').value);
            form.appendChild(enhealth);
 var enexperience = document.createElement("input");
            enexperience.setAttribute("type", "hidden");
            enexperience.setAttribute("name", "ensexperience");
            enexperience.setAttribute("value", document.getElementById('enexp').value);
            form.appendChild(enexperience);
//end
     if (hadEnsign)
{
     var ensskills = []
     var ensskillarr =  document.getElementsByName("ensskil");
     for(k=0;k<ensskillarr.length;k++)
     {
       if (ensskillarr[k].checked)
       {
       ensskills.push(ensskillarr[k].value);
       }
     }

     var ensskill = document.createElement("input");
            ensskill.setAttribute("type", "hidden");
            ensskill.setAttribute("name", "ensskill");
            ensskill.setAttribute("value", JSON.stringify(ensskills));
            form.appendChild(ensskill);
}
     else
     {
      var ensskill = document.createElement("input");
            ensskill.setAttribute("type", "hidden");
            ensskill.setAttribute("name", "ensskill");
            ensskill.setAttribute("value", document.getElementById('skillchoiceens').value);
            form.appendChild(ensskill);
     }
     var ensweap = document.createElement("input");
            ensweap.setAttribute("type", "hidden");
            ensweap.setAttribute("name", "ensweap");
            ensweap.setAttribute("value", document.getElementById('ensweapsel').value);
            form.appendChild(ensweap);
       }
     
     var troopsarr = []
                                for(i = 1; i < 11; i++)
                                {       
                                        var selector = document.getElementById('troop'+i);
                                        troopsarr.push(selector.value);
                                }


                  var j = 0; 
                  for(i = 0; i < 10; i++)
                  {
                    if (troopsarr[i] != "Empty")
                    {
                      boughtarr[j] = true;
                      j++;
                    }
                  }

     var troops = document.createElement("input");
            troops.setAttribute("type", "hidden");
            troops.setAttribute("name", "troops");
            troops.setAttribute("value", JSON.stringify(troopsarr));
            form.appendChild(troops);

     var bought = document.createElement("input");
            bought.setAttribute("type", "hidden");
            bought.setAttribute("name", "bought");
            bought.setAttribute("value", JSON.stringify(boughtarr));
            form.appendChild(bought);

    document.body.appendChild(form);
    form.submit();
    }
   }
</script>
</head>
<body>

<h1>Warband</h1>
<h2>Warband Name:<input type="text" id="bandnametext" name="bandnametext" value="{{ band['Name'] }}"></h2>
<input type="checkbox" name="public" id="public">Public


                <table border="0">
                        <tr>
<td><h3>Currency remaining: </h3></td>
                                <td id='remainingGold'>{{ band['Treasury'] }}</td>
                        </tr>
                </table>

<table>
  <tr>
               <td>
                 <input type="radio" name="topup" id="topup" value="10" checked><label>10</label>
                 <input type="radio" name="topup" id="topup" value="50"><label>50</label>
                 <input type="radio" name="topup" id="topup" value="100"><label>100</label>
               </td>

               <td>
                 <button type="button" onclick="topup()">Top up</button>
               </td>
  </tr>
</table>


<table id="wizardTable">
<tr>
                                <td>Move</td>
                                <td>Fight</td>
                                <td>Shoot</td>
                                <td>Shield</td>
                                <td>Morale</td>
                                <td>Health</td>
                                <td>Specialism</td>
                                <td>Weapons and Equipment</td>
                                <td>Weapons2</td>
                                <td>Items</td>
                                <td>Skills</td>
                                <td>Experience</td>
                        </tr>
<tr>
 
                               <td><div calss="capDiv" id="capMoveDiv">
                                          <input id="capmov" type="number" value="{{band['Captain']['Move']}}" disabled>
                                          <button type="button" id="capMoveButton" class="capButton" onclick="capStatChange(document.getElementById('capmov'))" disabled>Add</button> 
                               </div></td>
				<td><div calss="capDiv" id="capFightDiv">
                  <input id="capfig" type="number" value="{{band['Captain']['Fight']}}" max="10" disabled>
                  <button type="button" id="capFightButton" class="capButton" onclick="capStatChange(document.getElementById('capfig'))" disabled>Add</button> 
        </div></td>
                                <td><div calss="capDiv" id="capShootDiv">
                                          <input id="capsho" type="number" value="{{band['Captain']['Shoot']}}" max="10" disabled>
                                          <button type="button" id="capShootButton" class="capButton" onclick="capStatChange(document.getElementById('capsho'))" disabled>Add</button> 
                                </div></td>
                                <td><div calss="capDiv" id="capShieldDiv">
                                           <input id="capshi" type="number" value="{{band['Captain']['Shield']}}" disabled>
                                           <button type="button" id="capShieldButton" class="capButton" onclick="capStatChange(document.getElementById('capshi'))" disabled>Add</button> 
                                </div></td>
                                <td><div calss="capDiv" id="capMoraleDiv">
                                           <input id="capmor" type="number" value="{{band['Captain']['Morale']}}" max="12" disabled>
                                           <button type="button" id="capMoraleButton" class="capButton" onclick="capStatChange(document.getElementById('capmor'))" disabled>Add</button> 
                                </div></td>
                                <td><div calss="capDiv" id="capHealthDiv">
                                           <input id="caphea" type="number" value="{{band['Captain']['Health']}}" max="20" disabled>
                                           <button type="button" id="capHealthButton" class="capButton" onclick="capStatChange(document.getElementById('caphea'))" disabled>Add</button> 
                                </div></td>
                      
                                <td><select id="capspecsel" onchange="setCapSkillchoice(this)" disabled>
                                                <option value="Empty">Select...</option>
                                                {% for spec in specs %}
             					{% if spec == band['Captain']['Specialism']: %}
                                                <option value="{{ spec }}" selected>{{ spec }}</option>
                                                {% else %}
                                                <option value="{{ spec }}">{{ spec }}</option>
                                                {% endif %}
                                                {% endfor %}
                                        </select></td>
                                <td>
                                    <select id="capweapsel" onchange="updateCapWeapon()">
                                                <option value="Empty">Select...</option>
                                                {% for weap in weaps %}
                                                {% if weap == band['Captain']['Items'][0] %}
 						                                                <option value="{{ weap }}" id="{{ weap }}" selected>{{ weap }}</option>

      						{% else %}

                                                <option value="{{ weap }}" id="{{ weap }}">{{ weap }}</option>
						{%endif%}
                                                {% endfor %}
                                        </select></td>


                                <td>
                                    <select id="capweapsel2" onchange="updateCapWeapon2()">
                                                <option value="Empty">Select...</option>
                                                {% for weap in weaps %}
                                                {% if weap in band['Captain']['Items'][1] %}
                                                            <option value="{{ weap }}" id="{{ weap }}2" selected>{{ weap }}</option>

                  {% else %}

                                                <option value="{{ weap }}" id="{{ weap }}2">{{ weap }}</option>
            {%endif%}
                                                {% endfor %}
                                        </select></td>


                                <td>
                                    <select id="items">
                                                <option value="Empty">Select...</option>
                    
                                        </select>
                                </td>




                                <td>
                                     {% for opt in skills[band['Captain']['Specialism']] %}
                                        {% if opt in band['Captain']['Skillset'] %}
						<input type="checkbox"  name="capskil" value="{{opt}}" checked disabled>{{opt}}
 					{% else %}
						<input type="checkbox" name="capskil" class="capsk" value="{{opt}}" onclick="capSkill()" disabled>{{opt}}
					{% endif %}
				     {% endfor %} 
                                </td>
                                <td><div>
                                          <input id="capexp" type="number" value="{{band['Captain']['Experience']}}" disabled>
                                          <button type="button" id="capBattleButton" onclick="capBattle()">Battle</button> 
                                </div></td>
                        </tr>

</table>
Hire apprentice? <input type="checkbox" name="appHire" id="appHire" onClick="hireEng()" {% if 'Ensign' in band.keys() %} checked {%endif%}>250gc<br>
 {% if 'Ensign' in band.keys() %} 
<div id="ensignDiv" style='display: block'>

{%else%}
<div id="ensignDiv" style='display: none'>
{%endif%}
<table id="ensignTable">
<tr>
                                <td>Move</td>
                                <td>Fight</td>
                                <td>Shoot</td>
                                <td>Shield</td>
                                <td>Morale</td>
                                <td>Health</td>
                                <td>Specialism</td>
                                <td>Weapons and Equipment</td>
                                <td>Items</td>
                                <td>Skills</td>
                                <td>Experience</td>

                        </tr>
{% if 'Ensign' in band.keys() %}
<tr>

<td><div>
           <input id="enmov" type="number" value="{{band['Ensign']['Move']}}" disabled>
           <button type="button" id="ensMoveButton" class="ensButton" onclick="ensStatChange(document.getElementById('enmov'))" disabled>Add</button> 
</div></td>
                                <td><div>
                                           <input id="enfig" type="number" value="{{band['Ensign']['Fight']}}" max="6" disabled>
                                           <button type="button" id="ensFightButton" class="ensButton" onclick="ensStatChange(document.getElementById('enfig'))" disabled>Add</button> 
                                </div></td>
                                <td><div>
                                           <input id="ensho" type="number" value="{{band['Ensign']['Shoot']}}" max="5" disabled>
                                           <button type="button" id="ensShootButton" class="ensButton" onclick="ensStatChange(document.getElementById('ensho'))" disabled>Add</button> 
                                </div></td>
                                <td><div>
                                           <input id="enshi" type="number" value="{{band['Ensign']['Shield']}}">
                                           <button type="button" id="ensShieldButton" class="ensButton" onclick="ensStatChange(document.getElementById('enshi'))" disabled>Add</button> 
                                </div></td>
                                <td><div>
                                           <input id="enmor" type="number" value="{{band['Ensign']['Morale']}}" max="6" disabled>
                                           <button type="button" id="ensMoraleButton" class="ensButton" onclick="ensStatChange(document.getElementById('enmor'))" disabled>Add</button> 
                                </div></td>
                                <td><div>
                                           <input id="enhea" type="number" value="{{band['Ensign']['Health']}}" max="16" disabled>
                                           <button type="button" id="ensHealthButton" class="ensButton" onclick="ensStatChange(document.getElementById('enhea'))" disabled>Add</button> 
                                </div></td>                                <td>
<select id="ensskillsel" onchange="setEnsSkillchoice(this)" disabled>
  						<option value="Empty">Select...</option>
                                                {% for spec in specs %}

						{% if spec == band['Ensign']['Specialism']: %}
                                                <option value="{{ spec }}" selected>{{ spec }}</option>
                                                {% else %}
                                                <option value="{{ spec }}">{{ spec }}</option>
                                                {% endif %}
                                                {% endfor %}
  					</select>
</td>
                                <td>
<select id="ensweapsel" onchange="updateEensWeapon()">
                                                <option value="Empty">Select...</option>
                                                {% for weap in weaps %}
                                                {% if weap in band['Ensign']['Items'] %}
                                                                                                <option value="{{ weap }}" id="{{ weap }}ens" selected>{{ weap }}</option>
                                                {% else %}
        
                                                <option value="{{ weap }}" id="{{ weap }}ens">{{ weap }}</option>
                                                {%endif%}
                                                {% endfor %}
                                        </select>
</td>


                                <td>
                                    <select id="items">
                                                <option value="Empty">Select...</option>
                    
                                        </select>
                                </td>

                                <td>
{% for opt in skills[band['Ensign']['Specialism']] %}
                                        {% if opt in band['Ensign']['Skillset'] %}
                                                <input type="checkbox" name="ensskil"  value="{{opt}}" checked disabled>{{opt}}
                                        {% else %}
                                                <input type="checkbox" name="ensskil" class="enssk" value="{{opt}}" onclick="ensSkill()" disabled>{{opt}}
                                        {% endif %}
                                     {% endfor %}
</td>
                                <td><div>
                                          <input id="ensexp" type="number" value="{{apprentice['Ensign']['Experience']}}" disabled>
                                          <button type="button" id="ensBattleButton" onclick="ensBattle()">Battle</button> 
                                </div></td>

                        </tr>
{% else %}
<tr>
 <td>{{apprentice['Ensign']['Move']}}</td>
                                <td>{{apprentice['Ensign']['Fight']}}</td>
                                <td>{{apprentice['Ensign']['Shoot']}}</td>
                                <td>{{apprentice['Ensign']['Shield']}}</td>
                                <td>{{apprentice['Ensign']['Morale']}}</td>
                                <td>{{apprentice['Ensign']['Health']}}</td>
                                <td>
<select id="ensskillsel" onchange="setEnsSkillchoice(this)">
                                                <option value="Empty">Select...</option>
                                                {% for spec in specs %}

                                                {% if spec == apprentice['Ensign']['Specialism']: %}
                                                <option value="{{ spec }}" selected>{{ spec }}</option>
                                                {% else %}
                                                <option value="{{ spec }}">{{ spec }}</option>
                                                {% endif %}
                                                {% endfor %}
                                        </select>
</td>
                                <td>
<select id="ensweapsel" onchange="updateEensWeapon()">
                                                <option value="Empty">Select...</option>
                                                {% for weap in weaps %}

                                                <option value="{{ weap }}" id="{{ weap }}ens">{{ weap }}</option>
                                                {% endfor %}
                                        </select>
</td>

                                 <td>
                                    <select id="items">
                                                <option value="Empty">Select...</option>
                    
                                        </select>
                                </td>              


                                <td></td>
                                <td>
                                          <input id="capexp" type="number" value="{{apprentice['Ensign']['Experience']}}" disabled>
                                </td>

                        </tr>

{% endif %}
</table>
</div>
<table id='rosterTable'>
<tr>
				<td>Class</td>
				<td>Move</td>
				<td>Fight</td>
				<td>Shoot</td>
				<td>Shield</td>
				<td>Morale</td>
				<td>Health</td>
				<td>Cost</td>
				<td>Notes</td>
			</tr>

{% set p = 1 %}
{% for trooper in band['Troops'] %}
<tr>
<td>
<select id="troop{{p}}" onchange="updateTableRow({{ p }}, this)">
   <option value="Empty">Empty</option>
     {% for troop in people.keys() %}
       {% if troop == trooper: %}
        <option value="{{ troop }}" id="{{ troop }}{{ p }}" selected >{{ troop }}</option>
       {% else %}
        <option value="{{ troop }}" id="{{ troop }}{{ p }}">{{ troop }}</option>
       {% endif %}
      {% endfor %}
</select>
</td>
                                <td>{{ people[trooper]['Move'] }}</td>
                                <td>{{ people[trooper]['Fight'] }}</td>
                                <td>{{ people[trooper]['Shoot'] }}</td>
                                <td>{{ people[trooper]['Shield'] }}</td>
                                <td>{{ people[trooper]['Morale'] }}</td>
                                <td>{{ people[trooper]['Health'] }}</td>
                                <td>{{ people[trooper]['Cost'] }}</td>
                                <td>{{ people[trooper]['Notes'] }}</td>
                        </tr>
{% set p = p + 1 %}
{% endfor %}
{% for i in range((band['Troops']|length)+1,11) %}
<tr>
<td>
<select id="troop{{i}}" onchange="updateTableRow({{ i }}, this)">
   <option value="Empty">Empty</option>
     {% for troop in people.keys() %}
        <option value="{{ troop }}" id="{{ troop }}{{ i }}">{{ troop }}</option>
      {% endfor %}
</select>
</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                                <td>0</td>
                                <td>-</td>
                        </tr>
{% endfor %}
</table>
<input id="creator" type="button" value="Create Warband" onclick="doFormSubmit();" />
<input id="clear" type="button" value="Reset" onclick="window.location.href='/new'" />
<br><br>
<input id="back2" type="button" value="Back" onclick="window.location.href='/edit'" />
<input id="back" type="button" value="Back to Holderpage" onclick="window.location.href='/myaccount'" />
</body>
</html>

